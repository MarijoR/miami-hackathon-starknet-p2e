{"ast":null,"code":"\"use strict\";\n\nvar __read = this && this.__read || function (o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o),\n      r,\n      ar = [],\n      e;\n\n  try {\n    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  } catch (error) {\n    e = {\n      error: error\n    };\n  } finally {\n    try {\n      if (r && !r.done && (m = i[\"return\"])) m.call(i);\n    } finally {\n      if (e) throw e.error;\n    }\n  }\n\n  return ar;\n};\n\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.estimatedFeeToMaxFee = exports.compileCalldata = exports.formatSignature = exports.makeAddress = exports.randomAddress = exports.compressProgram = void 0;\n\nvar pako_1 = require(\"pako\");\n\nvar ellipticCurve_1 = require(\"./ellipticCurve\");\n\nvar encode_1 = require(\"./encode\");\n\nvar json_1 = require(\"./json\");\n\nvar number_1 = require(\"./number\");\n/**\n * Function to compress compiled cairo program\n *\n * [Reference](https://github.com/starkware-libs/cairo-lang/blob/master/src/starkware/starknet/services/api/gateway/transaction.py#L54-L58)\n * @param jsonProgram - json file representing the compiled cairo program\n * @returns Compressed cairo program\n */\n\n\nfunction compressProgram(jsonProgram) {\n  var stringified = typeof jsonProgram === 'string' ? jsonProgram : (0, json_1.stringify)(jsonProgram);\n  var compressedProgram = (0, pako_1.gzip)(stringified);\n  return (0, encode_1.btoaUniversal)(compressedProgram);\n}\n\nexports.compressProgram = compressProgram;\n\nfunction randomAddress() {\n  var randomKeyPair = (0, ellipticCurve_1.genKeyPair)();\n  return (0, ellipticCurve_1.getStarkKey)(randomKeyPair);\n}\n\nexports.randomAddress = randomAddress;\n\nfunction makeAddress(input) {\n  return (0, encode_1.addHexPrefix)(input).toLowerCase();\n}\n\nexports.makeAddress = makeAddress;\n\nfunction formatSignature(sig) {\n  if (!sig) return [];\n\n  try {\n    return sig.map(function (x) {\n      return (0, number_1.toBN)(x);\n    }).map(function (x) {\n      return x.toString();\n    });\n  } catch (e) {\n    return [];\n  }\n}\n\nexports.formatSignature = formatSignature;\n\nfunction compileCalldata(args) {\n  return Object.values(args).flatMap(function (value) {\n    if (Array.isArray(value)) return __spreadArray([(0, number_1.toBN)(value.length).toString()], __read(value.map(function (x) {\n      return (0, number_1.toBN)(x).toString();\n    })), false);\n    if (typeof value === 'object' && 'type' in value) return Object.entries(value).filter(function (_a) {\n      var _b = __read(_a, 1),\n          k = _b[0];\n\n      return k !== 'type';\n    }).map(function (_a) {\n      var _b = __read(_a, 2),\n          v = _b[1];\n\n      return (0, number_1.toBN)(v).toString();\n    });\n    return (0, number_1.toBN)(value).toString();\n  });\n}\n\nexports.compileCalldata = compileCalldata;\n\nfunction estimatedFeeToMaxFee(estimatedFee, overhead) {\n  if (overhead === void 0) {\n    overhead = 0.15;\n  } // BN can only handle Integers, so we need to do all calulations with integers\n\n\n  var overHeadPercent = Math.round((1 + overhead) * 100);\n  return (0, number_1.toBN)(estimatedFee).mul((0, number_1.toBN)(overHeadPercent)).div((0, number_1.toBN)(100));\n}\n\nexports.estimatedFeeToMaxFee = estimatedFeeToMaxFee;","map":{"version":3,"names":["__read","o","n","m","Symbol","iterator","i","call","r","ar","e","next","done","push","value","error","__spreadArray","to","from","pack","arguments","length","l","Array","prototype","slice","concat","Object","defineProperty","exports","estimatedFeeToMaxFee","compileCalldata","formatSignature","makeAddress","randomAddress","compressProgram","pako_1","require","ellipticCurve_1","encode_1","json_1","number_1","jsonProgram","stringified","stringify","compressedProgram","gzip","btoaUniversal","randomKeyPair","genKeyPair","getStarkKey","input","addHexPrefix","toLowerCase","sig","map","x","toBN","toString","args","values","flatMap","isArray","entries","filter","_a","_b","k","v","estimatedFee","overhead","overHeadPercent","Math","round","mul","div"],"sources":["/Users/marijoradman/y22/miami6/miami-hackathon-starknet-p2e/node_modules/starknet/dist/utils/stark.js"],"sourcesContent":["\"use strict\";\nvar __read = (this && this.__read) || function (o, n) {\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n    if (!m) return o;\n    var i = m.call(o), r, ar = [], e;\n    try {\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n    }\n    catch (error) { e = { error: error }; }\n    finally {\n        try {\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\n        }\n        finally { if (e) throw e.error; }\n    }\n    return ar;\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.estimatedFeeToMaxFee = exports.compileCalldata = exports.formatSignature = exports.makeAddress = exports.randomAddress = exports.compressProgram = void 0;\nvar pako_1 = require(\"pako\");\nvar ellipticCurve_1 = require(\"./ellipticCurve\");\nvar encode_1 = require(\"./encode\");\nvar json_1 = require(\"./json\");\nvar number_1 = require(\"./number\");\n/**\n * Function to compress compiled cairo program\n *\n * [Reference](https://github.com/starkware-libs/cairo-lang/blob/master/src/starkware/starknet/services/api/gateway/transaction.py#L54-L58)\n * @param jsonProgram - json file representing the compiled cairo program\n * @returns Compressed cairo program\n */\nfunction compressProgram(jsonProgram) {\n    var stringified = typeof jsonProgram === 'string' ? jsonProgram : (0, json_1.stringify)(jsonProgram);\n    var compressedProgram = (0, pako_1.gzip)(stringified);\n    return (0, encode_1.btoaUniversal)(compressedProgram);\n}\nexports.compressProgram = compressProgram;\nfunction randomAddress() {\n    var randomKeyPair = (0, ellipticCurve_1.genKeyPair)();\n    return (0, ellipticCurve_1.getStarkKey)(randomKeyPair);\n}\nexports.randomAddress = randomAddress;\nfunction makeAddress(input) {\n    return (0, encode_1.addHexPrefix)(input).toLowerCase();\n}\nexports.makeAddress = makeAddress;\nfunction formatSignature(sig) {\n    if (!sig)\n        return [];\n    try {\n        return sig.map(function (x) { return (0, number_1.toBN)(x); }).map(function (x) { return x.toString(); });\n    }\n    catch (e) {\n        return [];\n    }\n}\nexports.formatSignature = formatSignature;\nfunction compileCalldata(args) {\n    return Object.values(args).flatMap(function (value) {\n        if (Array.isArray(value))\n            return __spreadArray([(0, number_1.toBN)(value.length).toString()], __read(value.map(function (x) { return (0, number_1.toBN)(x).toString(); })), false);\n        if (typeof value === 'object' && 'type' in value)\n            return Object.entries(value)\n                .filter(function (_a) {\n                var _b = __read(_a, 1), k = _b[0];\n                return k !== 'type';\n            })\n                .map(function (_a) {\n                var _b = __read(_a, 2), v = _b[1];\n                return (0, number_1.toBN)(v).toString();\n            });\n        return (0, number_1.toBN)(value).toString();\n    });\n}\nexports.compileCalldata = compileCalldata;\nfunction estimatedFeeToMaxFee(estimatedFee, overhead) {\n    if (overhead === void 0) { overhead = 0.15; }\n    // BN can only handle Integers, so we need to do all calulations with integers\n    var overHeadPercent = Math.round((1 + overhead) * 100);\n    return (0, number_1.toBN)(estimatedFee).mul((0, number_1.toBN)(overHeadPercent)).div((0, number_1.toBN)(100));\n}\nexports.estimatedFeeToMaxFee = estimatedFeeToMaxFee;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}